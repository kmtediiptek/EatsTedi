import{q as N,W as G,r as n,j as l,F as K,a as e,b as U,y as b}from"./app-081f3543.js";import{A as o}from"./Actionbutton-d06f7bce.js";import{C as X}from"./Container-9e3dc6e2.js";import{P as Z}from"./Pagination-c5fd78cd.js";import{T as a}from"./Table-ee63abb5.js";import{A as ee}from"./App-4fd9dbe3.js";import{n as i}from"./Helper-c43eaa91.js";import{T as v}from"./TextInput-b48b3dcc.js";import{E as te}from"./jspdf.plugin.autotable-7ffd63b8.js";import{A as ae}from"./ActionLink-fdfbf142.js";import{S as le}from"./react-select.esm-dead390a.js";import{M as re}from"./Modal-2665796d.js";import{I as se,a as de}from"./IconPrinter-3099a3ce.js";import{I as S}from"./IconTrash-4d8bee97.js";import"./index-f1485e47.js";import"./transition-cc3e1cad.js";import"./typeof-7fd5df1e.js";import"./createReactComponent-10853b87.js";import"./defineProperty-4870f27f.js";function ne({total_qris:m,total_cash:_,banyak_transaksi:C,suppliers:R,rekap_transaksi:u,total_invoices:ie,...I}){const{data:P,meta:w,links:A}=I.invoices,{url:F}=N(),{data:d,setData:D,delete:j}=G({start_date:"",end_date:""}),[p,H]=n.useState(""),[x,q]=n.useState(!1),[h,z]=n.useState("all"),[E,f]=n.useState(!1),[J,M]=n.useState({}),[O,$]=n.useState([]),[y,ce]=n.useState(!0),{errors:c}=N().props;n.useEffect(()=>{$(u.slice().sort((t,r)=>new Date(r.purchased_at)-new Date(t.purchased_at)))},[u]);const T=t=>{D(t.target.name,t.target.value)},Q=t=>{const r=t?t.value:"all";z(r),b.get(F,{search:p,supplier:r!=="all"?r:null,start_date:d.start_date||null,end_date:d.end_date||null},{preserveState:!0,preserveScroll:!0})},W=()=>{b.get("/admin/rekap",{start_date:d.start_date,end_date:d.end_date,search:p,supplier:h!=="all"?h:null},{preserveState:!0,preserveScroll:!0}),q(!0)},L=t=>{if(x)try{const r=new te("landscape"),V=[["Invoice ID","Nama Supplier","Nama Customer","Nama Produk","Jenis Pembayaran","Harga","Jumlah","Total Harga","Waktu Pembelian"]],Y=u.map(s=>[s.invoice_id,s.supplier.name,s.invoice.customer_name,s.product.name,s.invoice.payment.name,`Rp. ${i(s.price)}`,s.quantity,`Rp. ${i(s.price*s.quantity)}`,s.purchased_at]);r.autoTable({head:V,body:Y,startY:20}),r.save("Report Order Eatstedi.pdf")}catch(r){console.error("Error generating PDF:",r)}else alert("Please apply the filter first.")},k=t=>{t.preventDefault(),H(t.target.value),b.get("/admin/rekap",{search:t.target.value},{preserveState:!0})},g=[{value:"all",label:"All Suppliers"},...R.slice().sort((t,r)=>t.name.localeCompare(r.name)).map(t=>({value:t.id,label:t.name}))],B=g.find(t=>t.value===h)||{value:"all",label:"All Suppliers"};return l(K,{children:[e(U,{title:"History"}),l(X,{children:[e("h3",{className:"text-2xl mt-10 mb-4 font-semibold text-fourth",children:"Rekap Transaksi"}),e("div",{className:"flex flex-wrap justify-between w-full item-center mt-2",children:e(ae,{href:route("admin.dashboard")})}),l("div",{className:"flex flex-wrap justify-between w-full item-center my-2",children:[l("div",{className:"flex items-center flex-wrap sm:flex-nowrap gap-2 w-full mb-2 md:mb-0 sm:w-full md:w-1/2",children:[l("div",{className:"w-full flex gap-2",children:[l("div",{className:"w-full",children:[e(v,{type:"date",name:"start_date",id:"start_date",className:"w-full",onChange:T,value:d.start_date}),c.start_date?e("span",{className:"text-red-500",children:c.start_date}):null]}),l("div",{className:"w-full",children:[e(v,{type:"date",name:"end_date",id:"end_date",className:"w-full",onChange:T,value:d.end_date}),c.end_date?e("span",{className:"text-red-500",children:c.end_date}):null]})]}),l("div",{className:"w-full sm:w-auto flex gap-2 justify-end sm:justify-start",children:[e(o,{className:"w-10 h-10 bg-violet",onClick:W,type:"button",disabled:!d.start_date||!d.end_date,children:e(se,{size:26})}),e(o,{className:"w-10 h-10",onClick:()=>L(),type:"button",disabled:!x,children:e(de,{size:26})})]})]}),l("div",{className:"w-full md:w-1/2 flex flex-wrap gap-2 justify-between",children:[e(v,{id:"searchInput",type:"search",className:"w-full md:w-1/2 ml-3 lg:w-2/5",placeholder:"Search rekap (invoice, supplier, product, etc.)",defaultValue:p,onChange:k,autoComplete:"off"}),e(le,{id:"supplier-select",value:B,options:g,className:"w-full md:w-1/2 lg:w-2/5",onChange:Q,styles:{control:(t,r)=>({...t,border:(r.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px"}),option:(t,r)=>({...t,backgroundColor:r.isSelected||r.isFocused?"#d4d4d8":null,color:"black"}),menu:t=>({...t,borderRadius:"8px"}),menuList:t=>({...t,borderRadius:"8px"})},theme:t=>({...t,borderRadius:8,colors:{...t.colors,primary25:"#d4d4d8",primary:"black"}})})]})]}),e("div",{className:"w-full"}),l(a,{children:[e(a.Thead,{children:l("tr",{children:[e(a.Th,{children:"#"}),e(a.Th,{children:"Invoice ID"}),e(a.Th,{children:"Nama Supplier"}),e(a.Th,{children:"Nama Customer"}),e(a.Th,{children:"Nama Produk"}),e(a.Th,{children:"Jenis Pembayaran"}),e(a.Th,{children:"Harga"}),e(a.Th,{children:"Jumlah"}),e(a.Th,{children:"Total Harga"}),e(a.Th,{children:"Waktu Pembelian"}),e(a.Th,{children:"Status"}),e(a.Th,{children:"Action"})]})}),e(a.Tbody,{children:y?O.map((t,r)=>l("tr",{className:"bg-white border-b",children:[e(a.Td,{className:"w-5",children:w.from+r}),l(a.Td,{children:["#",t.invoice_id]}),e(a.Td,{children:t.supplier.name}),e(a.Td,{children:t.invoice.customer_name}),e(a.Td,{children:t.product.name}),e(a.Td,{children:t.payment_name}),l(a.Td,{children:[e("sup",{children:" Rp."})," ",i(t.price)]}),e(a.Td,{children:i(t.quantity)}),l(a.Td,{children:[e("sup",{children:" Rp."})," ",i(t.price*t.quantity)]}),e(a.Td,{children:t.purchased_at}),e(a.Td,{children:e("span",{className:`text-xs p-2 ${t.invoice.status==1?"bg-green-500 text-white rounded":"bg-yellow-400 text-white rounded"}`,children:t.invoice.status==1?"Done":"In Progress"})}),e(a.Td,{children:e(o,{type:"button",onClick:()=>{f(!0),M(t)},className:"w-10 h-10",children:e(S,{size:26})})})]},r)):e("tr",{className:"bg-white border-b text-secondary text-center",children:e(a.Td,{colSpan:"12",children:"Tidak ada data yang ditemukan"})})})]}),P.length>0&&y&&l("div",{className:"flex w-full justify-between items-center",children:[e(Z,{meta:w,links:A}),l("div",{className:"flex gap-3",children:[l("p",{className:"text-sm text-third mt-10",children:["Total Rekap:"," ",e("span",{className:"font-bold",children:i(C)})," "]}),l("p",{className:"text-sm text-third mt-10",children:["Total Qris:"," ",e("span",{className:"font-bold",children:i(m)})," "]}),l("p",{className:"text-sm text-third mt-10",children:["Total Cash:"," ",e("span",{className:"font-bold",children:i(_)})," "]})]})]})]}),l(re,{isOpen:E,setIsOpen:f,size:"1/3",title:"Delete Confirmation",children:[e("div",{children:"Are you sure you want to delete this data?"}),e(o,{type:"button",className:"w-10 h-10 mt-5",onClick:()=>j(route("admin.rekap.destroy",J.id),{preserveScroll:!0,onSuccess:()=>f(!1)}),children:e(S,{size:20})})]})]})}ne.layout=m=>e(ee,{children:m});export{ne as default};
