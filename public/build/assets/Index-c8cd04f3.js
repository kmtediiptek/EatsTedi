import{r as f,q as b,W as $,j as i,F as J,a as e,b as D,y as v}from"./app-519d4450.js";import{A as S}from"./Actionbutton-c3908258.js";import{C as L}from"./Container-2edc54d1.js";import"./Table-4944571f.js";import{A as E}from"./App-a2ce6782.js";import{n as a}from"./Helper-c43eaa91.js";import{A as H}from"./ActionLink-253cabfe.js";import{T as Q}from"./TextInput-8e01371f.js";import{S as G}from"./react-select.esm-48900eb8.js";import{E as M}from"./jspdf.plugin.autotable-af6b04a7.js";import{I as W,a as Y}from"./IconPrinter-0585c8e7.js";import"./index-c4b4fe84.js";import"./transition-57a4f24b.js";import"./createReactComponent-eeb61691.js";import"./defineProperty-4870f27f.js";import"./typeof-7fd5df1e.js";function U({products_sold:x,suppliers:C,banyak_transaksi:c,total_qris:d,total_cash:N}){const[k,K]=f.useState(!1),{errors:h}=b().props,[O,P]=f.useState("all"),[A,V]=f.useState(""),{url:j}=b(),y=x.reduce((s,t)=>{const{name:l}=t.product,m=t.supplier.name;s[l]||(s[l]={totalCash:0,totalQris:0,totalTransactionsCash:0,totalTransactionsQris:0,totalOmset:0,totalKomisi:0,totalQrisKomisi:0,totalOmsetBersih:0,price:t.product.price,supplierName:m});const n=t.invoice.payment.name,o=t.price*t.quantity,r=n==="qris"?o*.1:0,u=o-r;return s[l].totalCash+=n==="cash"?o:0,s[l].totalQris+=n==="qris"?o:0,s[l].totalTransactionsCash+=n==="cash"?t.quantity:0,s[l].totalTransactionsQris+=n==="qris"?t.quantity:0,s[l].totalOmset+=o,s[l].totalKomisi+=n==="qris"?r:0,s[l].totalQrisKomisi+=n==="qris"?r:0,s[l].totalOmsetBersih+=u,s},{}),B=()=>{v.get("/admin/laporan",{start_date:p.start_date,end_date:p.end_date},{preserveState:!0}),K(!0)},{data:p,setData:F,delete:X}=$({start_date:"",end_date:""}),w=s=>{F(s.target.name,s.target.value)},_=s=>{try{const t=new M("landscape"),l=["No","Nama Penitip","Nama Produk","Harga Produk Satuan","Jumlah Pendapatan Cash","Jumlah Pendapatan Qris","Jumlah Transaksi Cash","Jumlah Transaksi Qris","Total Omset","Komisi 10%","Total Qris - Komisi","Omset Bersih"],m=[];let n=1;Object.entries(y).map(([o,r],u)=>{const R=r.price*r.totalTransactionsCash+r.price*r.totalTransactionsQris,T=(r.price*r.totalTransactionsCash+r.price*r.totalTransactionsQris)*.1,I=r.price*r.totalTransactionsQris-T;m.push([u+1,r.supplierName,o,a(r.price),a(r.price*r.totalTransactionsCash),a(r.price*r.totalTransactionsQris),a(r.totalTransactionsCash),a(r.totalTransactionsQris),a(R),a(T),a(I),a(r.totalOmsetBersih)])}),t.autoTable({head:[l],body:m,startY:20}),t.text(`Generated on ${new Date().toLocaleString()}`,14,t.internal.pageSize.height-10),t.text(`Total Rekap: ${a(c)}`,14,t.internal.pageSize.height-60),t.text(`Total Qris Kotor: ${a(d)}`,14,t.internal.pageSize.height-50),t.text(`Total Komisi Kantin (10%): ${a(c/10)}`,14,t.internal.pageSize.height-40),t.text(`Total Qris Bersih: ${a(d-c/10)}`,14,t.internal.pageSize.height-30),t.text(`Total Cash: ${a(N)}`,14,t.internal.pageSize.height-20),t.save("Laporan.pdf")}catch(t){console.error("Error generating PDF:",t)}},q=s=>{const t=s?s.value:"";P(t||"all"),v.get(j,{search:A,supplier:t},{preserveState:!0})},g=[{value:"all",label:"All Suppliers"},...C.map(s=>({value:s.id,label:s.name}))],z=g.find(s=>s.value===O)||{value:"all",label:"All Suppliers"};return i(J,{children:[e(D,{title:"History"}),i(L,{children:[e("h3",{className:"text-2xl mt-10 mb-4 font-semibold text-fourth",children:"Rekap Transaksi"}),e("div",{className:"flex  flex-wrap justify-between w-full item-center mt-2",children:e(H,{href:route("admin.dashboard")})}),i("div",{className:"flex  flex-wrap justify-between w-full item-center my-2",children:[i("div",{className:"flex items-center flex-wrap sm:flex-nowrap gap-2 w-full mb-2 md:mb-0 sm:w-full md:w-1/2",children:[i("div",{className:"w-full flex gap-2",children:[i("div",{className:"w-full",children:[e(Q,{type:"date",name:"start_date",id:"start_date",className:"w-full",onChange:w,value:p.start_date}),h.start_date?e("span",{className:"text-red-500",children:h.start_date}):null]}),i("div",{className:"w-full",children:[e(Q,{type:"date",name:"end_date",id:"end_date",className:"w-full",onChange:w,value:p.end_date}),h.end_date?e("span",{className:"text-red-500",children:h.end_date}):null]})]}),i("div",{className:"w-full sm:w-auto flex gap-2 justify-end sm:justify-start",children:[e(S,{className:"w-10 h-10 bg-violet",onClick:B,type:"button",disabled:!p.start_date||!p.end_date,children:e(W,{size:26})}),e(S,{className:"w-10 h-10",onClick:()=>_(),type:"button",disabled:!k,children:e(Y,{size:26})})]})]}),e(G,{id:"supplier-select",value:z,options:g,className:"w-full lg:w-1/4",onChange:q,styles:{control:(s,t)=>({...s,border:(t.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px"}),option:(s,t)=>({...s,backgroundColor:t.isSelected||t.isFocused?"#d4d4d8":null,color:"black"}),menu:s=>({...s,borderRadius:"8px"}),menuList:s=>({...s,borderRadius:"8px"})},theme:s=>({...s,borderRadius:8,colors:{...s.colors,primary25:"#d4d4d8",primary:"black"}})})]}),e("div",{className:"w-full"}),i("table",{className:"min-w-full divide-y divide-gray-200",children:[i("thead",{className:"bg-gray-50",children:[i("tr",{children:[e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Penitip"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama Produk"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Harga Produk Satuan"}),e("th",{colSpan:"2",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah Pendapatan"}),e("th",{colSpan:"2",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah Transaksi"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Omset"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Komisi 10%"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Qris - Komisi"}),e("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Omset Bersih"})]}),i("tr",{children:[e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3",children:"Cash"}),e("th",{className:"px-6 py-3",children:"Qris"}),e("th",{className:"px-6 py-3",children:"Cash"}),e("th",{className:"px-6 py-3",children:"Qris"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"}),e("th",{className:"px-6 py-3"})]})]}),e("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.entries(y).map(([s,t],l)=>{const m=t.price*t.totalTransactionsCash+t.price*t.totalTransactionsQris,n=(t.price*t.totalTransactionsCash+t.price*t.totalTransactionsQris)*.1,o=t.price*t.totalTransactionsQris-n;return i("tr",{children:[e("td",{className:"px-6 py-4 whitespace-nowrap",children:l+1}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:t.supplierName}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:s}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.price)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.price*t.totalTransactionsCash)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.price*t.totalTransactionsQris)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.totalTransactionsCash)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.totalTransactionsQris)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(m)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(n)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(o)}),e("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.totalOmsetBersih)})]},l)})})]}),e("div",{className:"flex w-full justify-between items-center",children:i("div",{className:"flex gap-3",children:[i("p",{className:"text-sm text-third mt-10",children:["Total Rekap:"," ",e("span",{className:"font-bold",children:a(c)})," "]}),i("p",{className:"text-sm text-third mt-10",children:["Total Qris Kotor:"," ",e("span",{className:"font-bold",children:a(d)})," "]}),i("p",{className:"text-sm text-third mt-10",children:["Total Komisi:"," ",e("span",{className:"font-bold",children:a(c/10)})," "]}),i("p",{className:"text-sm text-third mt-10",children:["Total Qris Bersih:"," ",e("span",{className:"font-bold",children:a(d-c/10)})," "]}),i("p",{className:"text-sm text-third mt-10",children:["Total Cash:"," ",e("span",{className:"font-bold",children:a(N)})," "]})]})})]})]})}U.layout=x=>e(E,{children:x});export{U as default};
