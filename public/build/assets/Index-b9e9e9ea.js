import{W as B,q as Q,r as d,y as f,j as s,a as e,F as x,b as _}from"./app-519d4450.js";import{A as $}from"./Actionbutton-c3908258.js";import{T as F}from"./TextInput-8e01371f.js";import{S as O}from"./react-select.esm-48900eb8.js";import{C as H}from"./Container-2edc54d1.js";import{M as J}from"./Modal-5ea36325.js";import{P as V}from"./Pagination-51d480c1.js";import{P as U}from"./PrimaryButton-62f49806.js";import{S as j}from"./SecondaryButton-3d48acf9.js";import{T as a}from"./Table-4944571f.js";import{T as W}from"./Toast-c79fcdec.js";import{A as Y}from"./App-a2ce6782.js";import{_ as G}from"./index-c4b4fe84.js";import{n as v}from"./Helper-c43eaa91.js";import{A as K}from"./ActionLink-253cabfe.js";import{T as D}from"./TabLink-0c965ec8.js";import{I as q}from"./InputLabel-32e3e1da.js";import{E}from"./Error-9510444b.js";import{c as X}from"./createReactComponent-eeb61691.js";import{I as Z}from"./IconTrash-f288ecce.js";import"./defineProperty-4870f27f.js";import"./typeof-7fd5df1e.js";import"./transition-57a4f24b.js";var ee=X("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]);function te(){const{data:c,setData:p,post:R}=B({supplier_id:"",daily_stocks:[]}),{errors:u,suppliers:S,daily_stocks:A}=Q().props,[w,i]=d.useState(null),[M,n]=d.useState(!1);d.useEffect(()=>{n(!0);const t=new URLSearchParams(window.location.search),l=t.get("supplier")||null,m=t.get("page")||1,h=t.get("search")||null;l&&(i(l),f.get("/admin/setting/product/today",{supplier:l,page:m,search:h},{preserveState:!0,onSuccess:C=>{p("daily_stocks",C.props.daily_stocks.data),n(!1)}}))},[]);const y=new URLSearchParams(window.location.search),g=y.get("supplier")||null,T=y.get("page")||1,P=y.get("search")||null;d.useEffect(()=>{n(!0),g&&(i(g),f.get("/admin/setting/product/today",{supplier:g,page:T,search:P},{preserveState:!0,onSuccess:t=>{p("daily_stocks",t.props.daily_stocks.data),n(!1)}}))},[g]);const N=t=>{const l=t?t.value:"";i(l||"all"),f.get("/admin/setting/product/today",{supplier:l},{preserveState:!0,onSuccess:m=>{p("daily_stocks",m.props.daily_stocks.data)}})},I=(t,l)=>{const m=c.daily_stocks.map(h=>h.product.id===l?{...h,quantity:t.target.value}:h);p("daily_stocks",m)},L=t=>{t.preventDefault(),R("/admin/setting/product/update-stock",{onSuccess:()=>{i(null),p({supplier_id:"",daily_stocks:[]}),setIsOpen(!1),toast.success("Stock updated successfully!")}})},b=S.map(t=>({value:t.id,label:t.name})),k=b.find(t=>t.value===w);return s("div",{children:[s("div",{className:"mb-6",children:[e(q,{htmlFor:"supplier",value:"Supplier"}),e(O,{id:"supplier-select",value:k,options:b,className:"w-full",onChange:N,styles:{control:(t,l)=>({...t,border:(l.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px",zIndex:9999}),option:(t,l)=>({...t,backgroundColor:l.isSelected||l.isFocused?"#d4d4d8":null,color:"black"}),menu:t=>({...t,borderRadius:"8px"}),menuList:t=>({...t,borderRadius:"8px"})},theme:t=>({...t,borderRadius:8,colors:{...t.colors,primary25:"#d4d4d8",primary:"black"}})}),u.supplier_id&&e(E,{value:u.supplier_id})]}),M?e(x,{children:e("div",{className:"h-8 bg-gray-300 rounded-full animate-pulse dark:bg-gray-700 max-w-[640px] mb-2.5 mx-auto"})}):e(x,{children:w||c.daily_stocks?e("form",{onSubmit:L,children:c.daily_stocks.length?s(x,{children:[e("hr",{}),e("h4",{className:"text-lg text-fourth font-medium leading-6 mt-4 mb-4",children:"Perbarui Seluruh Stock"}),c.daily_stocks.map(t=>s("div",{className:"flex w-full gap-2 mb-6",children:[s("div",{className:"w-full",children:[e(q,{htmlFor:`name-${t.product.id}`,value:"Name"}),e(F,{name:`name-${t.product.id}`,id:`name-${t.product.id}`,readOnly:!0,className:"w-full",value:t.product.name})]}),s("div",{className:"md:w-1/4",children:[e(q,{htmlFor:`quantity-${t.product.id}`,value:"Initial Quantity"}),e(F,{name:`quantity-${t.product.id}`,id:`quantity-${t.product.id}`,type:"number",className:"w-full",onChange:l=>I(l,t.product.id),defaultValue:t.rest||""}),u[`quantity-${t.product.id}`]&&e(E,{value:u[`quantity-${t.product.id}`]})]})]},t.product.id)),s("div",{className:"flex justify-end gap-2",children:[e(j,{type:"button",onClick:()=>i(null),children:"Cancel"}),e(U,{type:"submit",children:"Update Stock"})]})]}):e("div",{className:"flex w-full h-52 justify-center items-center text-fourth",children:e("h3",{children:"There are no products from this supplier"})})}):e("div",{className:"flex w-full h-52 justify-center items-center text-fourth",children:e("h3",{children:"Choose a Supplier First"})})})]})}function re({total_daily_stocks:c,suppliers:p,...R}){const{data:u,meta:S,links:A}=R.daily_stocks;let[w,i]=d.useState(!1);const[M,n]=d.useState(!1),[y,g]=d.useState(""),[T,P]=d.useState(""),[N,I]=d.useState(null),b=new URLSearchParams(window.location.search).get("supplier")||null;function k(){i(!0),g("Daily Menu")}function t(){n(!0)}const l=r=>{P(r.target.value),f.get("/admin/setting/product/today",{search:r.target.value,supplier:N},{preserveState:!0})},m=()=>{f.post("/admin/setting/product/reset-stock",{},{onSuccess:()=>{n(!1),G.success("Stock has been successfully reset!")}})},h=r=>{const o=r?r.value:"";I(o||"all"),f.get("/admin/setting/product/today",{search:T,supplier:o},{preserveState:!0})},C=[{value:"all",label:"All Suppliers"},...p.map(r=>({value:r.id,label:r.name}))],z=C.find(r=>r.value===N)||{value:"all",label:"All Suppliers"};return s(x,{children:[e(_,{title:"Setting"}),s(H,{children:[e("h3",{className:"text-2xl mt-10 mb-4 font-semibold text-fourth",children:"Daily Menus"}),s("div",{className:"w-full flex justify-between my-2",children:[s("div",{className:"flex w-full md:w-1/2 gap-2",children:[e(K,{href:route("admin.dashboard")}),e($,{onClick:()=>k(),type:"button",children:e(ee,{size:18})}),e($,{onClick:()=>t(),type:"button",children:e(Z,{size:18})})]}),s("div",{className:"flex w-full  md:w-1/2 gap-2",children:[e(O,{id:"supplier-select",value:z,options:C,className:"w-full md:w-1/2 md:order-1 order-2",onChange:h,styles:{control:(r,o)=>({...r,border:(o.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px"}),option:(r,o)=>({...r,backgroundColor:o.isSelected||o.isFocused?"#d4d4d8":null,color:"black"}),menu:r=>({...r,borderRadius:"8px"}),menuList:r=>({...r,borderRadius:"8px"})},theme:r=>({...r,borderRadius:8,colors:{...r.colors,primary25:"#d4d4d8",primary:"black"}})}),e(F,{type:"search",className:"w-full md:order-2 order-1 md:w-1/2",placeholder:"Search menu..",value:T,onChange:l})]})]}),s("div",{className:"w-full flex items-center gap-2 py-2",children:[e(D,{href:route("admin.product.index"),active:route().current("admin.product.index"),children:"All Menu"}),e(D,{href:route("admin.product.today.index"),active:route().current("admin.product.today.index"),children:"Daily Menu"})]}),s(a,{children:[e(a.Thead,{children:s("tr",{children:[e(a.Th,{children:"No"}),e(a.Th,{children:"Supplier"}),e(a.Th,{children:"Nama"}),e(a.Th,{children:"Harga"}),e(a.Th,{children:"Terjual"}),e(a.Th,{children:"Sisa Stok"}),e(a.Th,{children:"Total Jumlah"}),e(a.Th,{children:"Total Harga"}),e(a.Th,{children:"Action"})]})}),e(a.Tbody,{children:u.length>0?e(x,{children:u.map((r,o)=>s("tr",{className:"bg-white border-b",children:[e(a.Td,{className:"w-5",children:S.from+o}),e(a.Td,{className:"font-bold",children:r.product.supplier.name.toUpperCase()}),e(a.Td,{children:r.product.name}),s(a.Td,{children:[e("sup",{children:" Rp."})," ",v(r.product.price)]}),e(a.Td,{children:v(r.sold)}),e(a.Td,{children:v(r.rest)}),e(a.Td,{children:v(r.quantity)}),s(a.Td,{children:[e("sup",{children:" Rp."})," ",v(r.quantity*r.product.price)]}),e(a.Td,{children:e(j,{onClick:()=>{f.get("/admin/setting/product/today",{supplier:r.product.supplier.id,page:b==="all"||!b?1:S.current_page,search:r.product.name},{preserveState:!0}),k()},children:"Edits"})})]},o))}):e("tr",{className:"bg-white border-b text-secondary text-center",children:e(a.Td,{colSpan:"8",children:"No data"})})})]}),u.length>0&&s("div",{className:"flex w-full justify-between items-center",children:[e(V,{meta:S,links:A}),s("p",{className:"text-sm text-third mt-10",children:["Total Products:"," ",e("span",{className:"font-bold",children:c})," "]})]}),e(J,{isOpen:w,onClose:()=>i(i),setIsOpen:i,size:"1/2",title:y,children:e(te,{})}),e(W,{isToast:M,onClose:()=>n(!1),title:"This action will start the process of resetting all Product Stock. Are you sure you want to reset Stock?",children:s("div",{className:"flex justify-end gap-2 justify-end",children:[e(j,{onClick:()=>n(!1),className:"w-32",children:"No"}),e(U,{onClick:()=>m(),className:"w-32",children:"Yes"})]})})]})]})}re.layout=c=>e(Y,{children:c});export{re as default};
