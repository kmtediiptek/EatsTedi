import{W as O,q as B,r as u,y as m,j as l,a as e,F as T,b as H}from"./app-081f3543.js";import{A as Q}from"./Actionbutton-d06f7bce.js";import{T as j}from"./TextInput-b48b3dcc.js";import{S as W}from"./react-select.esm-dead390a.js";import{C as J}from"./Container-9e3dc6e2.js";import{M as Y}from"./Modal-2665796d.js";import{P as G}from"./Pagination-c5fd78cd.js";import{P as U}from"./PrimaryButton-a074050f.js";import{S as A}from"./SecondaryButton-695f0f2c.js";import{T as s}from"./Table-ee63abb5.js";import{T as K}from"./Toast-1b3d1cf2.js";import{A as V}from"./App-4fd9dbe3.js";import{_ as z}from"./index-f1485e47.js";import{n as w}from"./Helper-c43eaa91.js";import{A as X}from"./ActionLink-fdfbf142.js";import{T as _}from"./TabLink-66f329fc.js";import{I as F}from"./InputLabel-3eeb76a6.js";import{E}from"./Error-7eaef181.js";import{c as Z}from"./createReactComponent-10853b87.js";import{I as ee}from"./IconTrash-4d8bee97.js";import"./defineProperty-4870f27f.js";import"./typeof-7fd5df1e.js";import"./transition-cc3e1cad.js";var te=Z("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]);function re({setIsOpen:h}){const{data:f,setData:d,post:x}=O({supplier_id:"",daily_stocks:[]}),{errors:p,suppliers:R,daily_stocks:L}=B().props,[c,g]=u.useState(null),[y,S]=u.useState(!1),M=t=>{t.target.blur()};u.useEffect(()=>{S(!0);const t=new URLSearchParams(window.location.search),a=t.get("supplier")||null,n=t.get("page")||1,o=t.get("search")||null;a&&(g(a),m.get("/admin/setting/product/today",{supplier:a,page:n,search:o},{preserveState:!0,onSuccess:r=>{const i=r.props.daily_stocks.data.map(D=>({...D,quantity:D.rest||0}));d("daily_stocks",i),S(!1)}}))},[]);const b=new URLSearchParams(window.location.search),v=b.get("supplier")||null,N=b.get("page")||1,P=b.get("search")||null;u.useEffect(()=>{S(!0),v&&(g(v),m.get("/admin/setting/product/today",{supplier:v,page:N,search:P},{preserveState:!0,onSuccess:t=>{const a=t.props.daily_stocks.data.map(n=>({...n,quantity:n.rest||0}));d("daily_stocks",a),S(!1)}}))},[v]);const $=t=>{const a=t?t.value:"";g(a||"all"),m.get("/admin/setting/product/today",{supplier:a},{preserveState:!0,onSuccess:n=>{const o=n.props.daily_stocks.data.map(r=>({...r,quantity:r.rest||0}));d("daily_stocks",o)}})},C=(t,a)=>{const n=f.daily_stocks.map(o=>o.product.id===a?{...o,quantity:t.target.value}:o);d("daily_stocks",n)},k=t=>{t.preventDefault(),d("supplier_id",c),x("/admin/setting/product/update-stock",{onSuccess:()=>{const a=c;d({supplier_id:a,daily_stocks:[]}),typeof h=="function"&&h(!1),z.success("Stock updated successfully!"),m.get("/admin/setting/product/today",{supplier:a},{preserveState:!0,onSuccess:n=>{const o=n.props.daily_stocks.data.map(r=>({...r,quantity:r.rest||0}));d({supplier_id:a,daily_stocks:o})}})}})},q=R.slice().sort((t,a)=>t.name.localeCompare(a.name)).map(t=>({value:t.id,label:t.name})),I=q.find(t=>t.value===c);return l("div",{children:[l("div",{className:"mb-6",children:[e(F,{htmlFor:"supplier",value:"Supplier"}),e(W,{id:"supplier-select",value:I,options:q,className:"w-full",onChange:$,styles:{control:(t,a)=>({...t,border:(a.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px",zIndex:9999}),option:(t,a)=>({...t,backgroundColor:a.isSelected||a.isFocused?"#d4d4d8":null,color:"black"}),menu:t=>({...t,borderRadius:"8px"}),menuList:t=>({...t,borderRadius:"8px"})},theme:t=>({...t,borderRadius:8,colors:{...t.colors,primary25:"#d4d4d8",primary:"black"}})}),p.supplier_id&&e(E,{value:p.supplier_id})]}),y?e(T,{children:e("div",{className:"h-8 bg-gray-300 rounded-full animate-pulse dark:bg-gray-700 max-w-[640px] mb-2.5 mx-auto"})}):e(T,{children:c||f.daily_stocks?e("form",{onSubmit:k,children:f.daily_stocks.length?l(T,{children:[e("hr",{}),e("h4",{className:"text-lg text-fourth font-medium leading-6 mt-4 mb-4",children:"Perbarui Seluruh Stock"}),f.daily_stocks.map(t=>l("div",{className:"flex w-full gap-2 mb-6",children:[l("div",{className:"w-full",children:[e(F,{htmlFor:`name-${t.product.id}`,value:"Name"}),e(j,{name:`name-${t.product.id}`,id:`name-${t.product.id}`,readOnly:!0,className:"w-full",value:t.product.name})]}),l("div",{className:"md:w-1/4",children:[e(F,{htmlFor:`quantity-${t.product.id}`,value:"Initial Quantity"}),e(j,{name:`quantity-${t.product.id}`,id:`quantity-${t.product.id}`,type:"number",className:"w-full noSpinner",inputMode:"numeric",pattern:"[0-9]*",onWheel:M,onChange:a=>C(a,t.product.id),value:t.quantity||""}),p[`quantity-${t.product.id}`]&&e(E,{value:p[`quantity-${t.product.id}`]})]})]},t.product.id)),l("div",{className:"flex justify-end gap-2",children:[e(A,{type:"button",onClick:()=>g(null),children:"Cancel"}),e(U,{type:"submit",children:"Update Stock"})]})]}):e("div",{className:"flex w-full h-52 justify-center items-center text-fourth",children:e("h3",{children:"There are no products from this supplier"})})}):e("div",{className:"flex w-full h-52 justify-center items-center text-fourth",children:e("h3",{children:"Choose a Supplier First"})})})]})}function ae({total_daily_stocks:h,suppliers:f,...d}){const{data:x,meta:p,links:R}=d.daily_stocks;let[L,c]=u.useState(!1);const[g,y]=u.useState(!1),[S,M]=u.useState(""),[b,v]=u.useState(""),[N,P]=u.useState(null),C=new URLSearchParams(window.location.search).get("supplier")||null;function k(){c(!0),M("Daily Menu")}function q(){y(!0)}const I=r=>{v(r.target.value),m.get("/admin/setting/product/today",{search:r.target.value,supplier:N},{preserveState:!0})},t=()=>{m.post("/admin/setting/product/reset-stock",{},{onSuccess:()=>{y(!1),z.success("Stock has been successfully reset!")}})},a=r=>{const i=r?r.value:"";P(i||"all"),m.get("/admin/setting/product/today",{search:b,supplier:i},{preserveState:!0})},n=[{value:"all",label:"All Suppliers"},...f.slice().sort((r,i)=>r.name.localeCompare(i.name)).map(r=>({value:r.id,label:r.name}))],o=n.find(r=>r.value===N)||{value:"all",label:"All Suppliers"};return l(T,{children:[e(H,{title:"Setting"}),l(J,{children:[e("h3",{className:"text-2xl mt-10 mb-4 font-semibold text-fourth",children:"Daily Menus"}),l("div",{className:"w-full flex justify-between my-2",children:[l("div",{className:"flex w-full md:w-1/2 gap-2",children:[e(X,{href:route("admin.dashboard")}),e(Q,{onClick:()=>k(),type:"button",children:e(te,{size:18})}),e(Q,{onClick:()=>q(),type:"button",children:e(ee,{size:18})})]}),l("div",{className:"flex w-full  md:w-1/2 gap-2",children:[e(W,{id:"supplier-select",value:o,options:n,className:"w-full md:w-1/2 md:order-1 order-2",onChange:a,styles:{control:(r,i)=>({...r,border:(i.isFocused,"2px solid #d4d4d8"),boxShadow:"none","&:hover":{border:"2px solid #d4d4d8"},height:"44px",borderRadius:"8px"}),option:(r,i)=>({...r,backgroundColor:i.isSelected||i.isFocused?"#d4d4d8":null,color:"black"}),menu:r=>({...r,borderRadius:"8px"}),menuList:r=>({...r,borderRadius:"8px"})},theme:r=>({...r,borderRadius:8,colors:{...r.colors,primary25:"#d4d4d8",primary:"black"}})}),e(j,{type:"search",className:"w-full md:order-2 order-1 md:w-1/2",placeholder:"Search menu..",value:b,onChange:I})]})]}),l("div",{className:"w-full flex items-center gap-2 py-2",children:[e(_,{href:route("admin.product.index"),active:route().current("admin.product.index"),children:"All Menu"}),e(_,{href:route("admin.product.today.index"),active:route().current("admin.product.today.index"),children:"Daily Menu"})]}),l(s,{children:[e(s.Thead,{children:l("tr",{children:[e(s.Th,{children:"No"}),e(s.Th,{children:"Supplier"}),e(s.Th,{children:"Nama"}),e(s.Th,{children:"Harga"}),e(s.Th,{children:"Terjual"}),e(s.Th,{children:"Sisa Stok"}),e(s.Th,{children:"Total Jumlah"}),e(s.Th,{children:"Total Harga"}),e(s.Th,{children:"Action"})]})}),e(s.Tbody,{children:x.length>0?e(T,{children:x.map((r,i)=>l("tr",{className:"bg-white border-b",children:[e(s.Td,{className:"w-5",children:p.from+i}),e(s.Td,{className:"font-bold",children:r.product.supplier.name.toUpperCase()}),e(s.Td,{children:r.product.name}),l(s.Td,{children:[e("sup",{children:" Rp."})," ",w(r.product.price)]}),e(s.Td,{children:w(r.sold)}),e(s.Td,{children:w(r.rest)}),e(s.Td,{children:w(r.quantity)}),l(s.Td,{children:[e("sup",{children:" Rp."})," ",w(r.quantity*r.product.price)]}),e(s.Td,{children:e(A,{onClick:()=>{m.get("/admin/setting/product/today",{supplier:r.product.supplier.id,page:C==="all"||!C?1:p.current_page,search:r.product.name},{preserveState:!0}),k()},children:"Edits"})})]},i))}):e("tr",{className:"bg-white border-b text-secondary text-center",children:e(s.Td,{colSpan:"8",children:"No data"})})})]}),x.length>0&&l("div",{className:"flex w-full justify-between items-center",children:[e(G,{meta:p,links:R}),l("p",{className:"text-sm text-third mt-10",children:["Total Products:"," ",e("span",{className:"font-bold",children:h})," "]})]}),e(Y,{isOpen:L,onClose:()=>c(c),setIsOpen:c,size:"1/2",title:S,children:e(re,{})}),e(K,{isToast:g,onClose:()=>y(!1),title:"This action will start the process of resetting all Product Stock. Are you sure you want to reset Stock?",children:l("div",{className:"flex justify-end gap-2 justify-end",children:[e(A,{onClick:()=>y(!1),className:"w-32",children:"No"}),e(U,{onClick:()=>t(),className:"w-32",children:"Yes"})]})})]})]})}ae.layout=h=>e(V,{children:h});export{ae as default};
